<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marksheet Print System</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> 
	<!-- Marksheet Dsn code Pluggin -->
	<link rel="stylesheet" href="https://trollifyindustry.github.io/snpskhamra/system/marksheet/marksheetDesign/marksheetStyle.css" />

</head>

<div class="inone" >
    <h2>1st to  5th Marksheet Print System</h2>
  
  
  
    <button onclick="fetchData()" class="inone btn1" >Load Marksheet</button>
    <button onclick="printData()" class="inone btn1" >Print</button>  
  

  
  <!------sheet link Button----------->
  <a href="https://docs.google.com/spreadsheets/d/1H6ISZpDh73neECZOmYtDKnQTw-f5fGZe9f8Tdqk7rB0/edit?gid=0#gid=0"><button class=" inone btn1">Sheet Link</button></a>
 <!-----##End-sheet link Button----------->
  
  
  
  </div>
    <div id="invoiceContainer"></div>

    <script>
        let invoices = [];

        function fetchData() {
            // Show SweetAlert spinner
            Swal.fire({
                title: 'Loading Marksheet...',
                html: '<div class="spinner"></div>',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            fetch("https://script.google.com/macros/s/AKfycbwWYbYCjO2Gi_JeGjmSSaasV5NsUqTcu3jpNzirATw2vEebz0dyXHi-YSSQzrT3uUx3Xw/exec")
                .then(response => response.json())
                .then(data => {
                    Swal.close(); // Hide spinner once data is loaded
                    let container = document.getElementById("invoiceContainer");
                    container.innerHTML = "";
                    invoices = []; // Reset invoices array

                    data.forEach(row => {
                        let invoice = document.createElement("div");
                        invoice.className = "invoice";
                        invoice.style.display = "block"; // Show invoices properly
                      
                //number formate code like 23.3                      
                       function formatNumber(value) {
                            let num = parseFloat(value);
                            if (!isNaN(num)) {
                                let decimalCount = (num.toString().split('.')[1] || "").length;
                                return decimalCount > 1 ? num.toFixed(1) : num;
                            }
                            return value; // If not a number, return as it is
                        }

                      
                        invoice.innerHTML = `
                 	 <body> 
                    
                   <div class="r" >  
                   <img class="img" src="${row[21]}"> 
                   <img class="studentphoto" src="${row[12]}">
                    <br> <br><br><br><br><br>
                    
            <table class="nametable">
                   <tr>
                       <th class="name" width="180px">STUDENT'S NAME</th>
                       <td class="name" width="430px"> : ${row[0]}</td>
                       <th class="name" width="130px">ROLL NUMBER</th>
                       <td class="name"> : ${row[1]}</td>
                   </tr>
                   <tr>
                       <th class="name">FATHER'S NAME</th>
                       <td class="name"> : ${row[2]}</td>
                       <th class="name">CLASS</th>
                       <td class="name"> : ${row[6]}</td>
                   </tr>
                   <tr>
                       <th class="name">MOTHER'S NAME</th>
                       <td class="name"> : ${row[3]}</td>
                       <th class="name">SCHOLAR NO.</th>
                       <td class="name"> : ${row[9]}</td>
                   </tr>
                   <tr>
                       <th class="name">DATE OF BIRTH</th>
                       <td class="name"> : ${row[4]}</td>
                       <th class="name">GENDER</th>
                       <td class="name"> : ${row[8]}</td>
                   </tr>
            </table>
                   
                   
                   
                   
                   
                   
                   <br><br><br><br><br><br><br>
                   
                   <h3 class="marksHeading" >ASSESSMENT SHEET</h3>
                   
         
                    <table class="mtt"> 
                <tr>  
                   <th rowspan="3">Sr.N.</th>  
                   <th rowspan="3" width="">SUBJECT</th>  
                   <th colspan="2" rowspan="2">MONTHLY <br> EVALUATION <br> (10 MARKS)</th>  
                   <th colspan="2" rowspan="2">HALF YEARLY <br> EVALUATION <br> (20 MARKS)</th>  
                   <th colspan="4">ANNUAL EVALUATION (70 MARKS)</th>       
                   <th rowspan="3">TOTAL MARKS (100)</th>  
                   <th rowspan="3">OVERALL GRADE</th> <td class="nam" >...</td>  
                </tr>  
                <tr>  
                   <th colspan="2">WRITTEN  <br> (60 MARKS)</th>  
                   <th colspan="2">CO-CURRICULAR <br> ACTIVITIES <br>(10 MARKS)</th>    
                </tr>  
                <tr>  
                   <th>MARKS OBTAINED</th>  
                   <th>GRADE</th>  
                   <th>MARKS OBTAINED</th>  
                   <th>GRADE</th>  
                   <th>MARKS OBTAINED</th>  
                   <th>GRADE</th>  
                   <th>MARKS OBTAINED</th>  
                   <th>GRADE</th>  
                </tr>  
                <tr>  
                   <td>1</td>  
                   <td>HINDI</td>  
                   <td>${row[39]}</td> <td>${row[40]}</td>  
                   <td>${row[57]}</td> <td>${row[58]}</td>  
                   <td>${row[74]}</td> <td>${row[75]}</td>  
                   <td>${row[87]}</td> <td>${row[88]}</td>  
                   <td>${formatNumber(row[104])}</td> <td>${row[105]}</td>  
                </tr>  
                <tr>  
                   <td>2</td>  
                   <td>ENGLISH</td>  
                   <td>${row[42]}</td> <td>${row[43]}</td>  
                   <td>${row[60]}</td> <td>${row[61]}</td>  
                   <td>${row[76]}</td> <td>${row[77]}</td>  
                   <td>${row[90]}</td> <td>${row[91]}</td>  
                   <td>${formatNumber(row[106])}</td> <td>${row[107]}</td>  
                </tr>  
                <tr>  
                   <td>3</td>  
                   <td>MATHEMATICS</td>  
                   <td>${row[45]}</td> <td>${row[46]}</td>  
                   <td>${row[63]}</td> <td>${row[64]}</td>  
                   <td>${row[78]}</td> <td>${row[79]}</td>  
                   <td>${row[93]}</td> <td>${row[94]}</td>  
                   <td>${formatNumber(row[108])}</td> <td>${row[109]}</td>  
                </tr>  
                <tr>  
                   <td>4</td>  
                   <td>EVS</td>  
                   <td>${row[48]}</td> <td>${row[49]}</td>  
                   <td>${row[66]}</td> <td>${row[67]}</td>  
                   <td>${row[80]}</td> <td>${row[81]}</td>  
                   <td>${row[96]}</td> <td>${row[97]}</td>  
                   <td>${formatNumber(row[110])}</td> <td>${row[111]}</td>  
                </tr>  
                <tr>  
                   <td>5</td>  
                   <td>DRAWING</td>  
                   <td>${row[51]}</td> <td>${row[52]}</td>  
                   <td>${row[69]}</td> <td>${row[70]}</td>  
                   <td>${row[82]}</td> <td>${row[83]}</td>  
                   <td>${row[99]}</td> <td>${row[100]}</td>  
                   <td>${formatNumber(row[112])}</td> <td>${row[113]}</td>  
                </tr>  
                <tr>  
                   <td>6</td>  
                   <td>PROJECT</td>  
                   <td>${row[54]}</td>   <td>${row[55]}</td>  
                   <td>${row[72]}</td>   <td>${row[73]}</td>  
                   <td>${row[84]}</td>   <td>${row[85]}</td>  
                   <td>${row[102]}</td>  <td>${row[103]}</td>  
                   <td>${formatNumber(row[114])}</td> <td>${row[115]}</td>  
                </tr>  
                   </table>  
                   
                  <br><br><br><br><br><br><br><br><br><br><br>
                   
        <table class="lt" > 
            <tr>  
                   <th width="70px">GRADE</th>  
                   <th width="150px">REMARK</th>      
            </tr>  
            <tr>  
                   <td class="grade" >A+</td>  
                   <td class="grade">EXCELLENT</td>
            </tr>  
            <tr>  
                   <td classs="grade">A</td>                     
                   <td classs="grade">GOOD</td>  
            </tr>
			<tr>
                   <td class="grade">B+</td>                     
                   <td class="grade">GOOD</td>  
            </tr>
			<tr>
                   <td class="grade">B</td>                     
                   <td class="grade">AVERAGE</td>  
            </tr> 
            <tr>
                   <td class="grade">C</td>                     
                   <td class="grade">BELOW AVERAGE</td>  
            </tr>
			<tr>
                   <td class="grade">D</td>                     
                   <td classs="grade">FAIL</td>  
            </tr>        
        </table> 

                   
				   
    </div>  
                   
                   <br><br><br><br><br>
                   
				   

    <table class="st">
       <tr>
          <td  width=""><b>TOTAL WORKING DAYS: </b>${row[18]}</td>
          <td width=""><b>PROMOTED TO CLASS: </b>${row[17]}</td>
          <td  width=""><b>TOTAL SCORE: </b>${formatNumber(row[13])}</td>
          <th rowspan="2" style="text-align:center;">RESULT : ${row[16]}</th>
        </tr>
        <tr>
          <td><b>TOTAL ATTENDANCE: </b>${row[19]}</td>
          <td  width=""><b>ATTENDANCE PERCENTAGE: </b>${formatNumber(row[14])}% </td>
          <td><b>GRADE : </b>${row[15]}</td>
        </tr>
        <tr>
           <td colspan="4"><b>Class Teacherâ€™s Remarks:</b> Very Good keep it up.</td>
        </tr>
    </table>

                   
                   
              
     <p class="issueDate">Issue Date :${row[10]}</p>
     <img class="qr" src="${row[20]}">
     
     <p class="prem-janghela"> Prepared through <b>TROLLIFY INDUSTRY,</b> designed for SNPS by <b>Prem Janghela</b>,9752776923 <p>
 
 
 
 <table class="singnatureTable">  
    <tr>
        <td class="singnatureTd"><b>Place:</b> Khamra</td>
        <td class="singnatureTd">${row[10]}</td>
        <td class="singnatureTd">${row[11]}</td>
        <td class="singnatureTd">${row[20]}</td>
    </tr>
    <tr>
        <td class="singnatureTd"><b>Date:</b> 29/03/2025</td>
        <td class="singnatureTd"><b>CLASS TEACHER</b></td>
        <td class="singnatureTd"><b>ACADEMIC INCHARGE</b></td>
        <td class="singnatureTd"><b>PRINCIPAL</b></td>
    </tr>
 </table>
 

                      
</body> 
       <br><br><br><br><br><br><br><br><br><br><br> 
                      
                        `;
                        container.appendChild(invoice);
                        invoices.push(invoice); // Store invoice elements
                    });
                })
                .catch(error => {
                    Swal.close(); // Hide spinner on error
                    Swal.fire("Error", "Failed to load Marksheet. Please try again.", "error");
                    console.error("Error fetching data:", error);
                });
        }

        function printData() {
            if (invoices.length === 0) {
                Swal.fire("Warning", "No data to print. Please load Marksheet first.", "warning");
                return;
            }

            setTimeout(() => {
                window.print();
            }, 500); // 500ms delay so content fully loads before print
        }
    </script>
  
</html>
<style>
.btn1 {
      padding: 6px 30px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      transition-duration: 0.4s;
      cursor: pointer;
      border: 1.4px solid #000;
      border-radius: 15px 0 10px 0;
}
.btn1:hover {
      background-color: #04AA6D;
      color: white;
}
</style>
